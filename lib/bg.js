// Generated by CoffeeScript 1.6.3
(function() {
  var has_open_window, last_window_id, openWindow;

  has_open_window = false;

  last_window_id = void 0;

  openWindow = function() {
    var popup;
    popup = {
      type: 'popup',
      url: 'index.html',
      left: 600,
      width: 400,
      height: 600,
      focused: true
    };
    return chrome.windows.create(popup, function(win) {
      chrome.windows.update(win.id, {
        drawAttention: true
      });
      return console.log('saving last_window_id', last_window_id = win.id);
    });
  };

  chrome.commands.onCommand.addListener(function(command) {
    if (command === "launch") {
      console.log('going to open a windows');
      console.info('has_open_window', has_open_window);
      console.info('last_window_id', last_window_id);
      if (has_open_window) {
        if (last_window_id != null) {
          return chrome.windows.update(last_window_id, {
            focused: true
          });
        }
      } else {
        openWindow();
        return has_open_window = true;
      }
    }
  });

  chrome.extension.onMessage.addListener(function(req, sender, msg) {
    if (req.word === 'close') {
      console.log('close');
      has_open_window = false;
      return last_window_id = null;
    } else if (req.word === 'log') {
      return console.log('log::', req.data);
    }
  });

  chrome.browserAction.onClicked.addListener(function(tab) {
    return openWindow();
  });

}).call(this);

/*
//@ sourceMappingURL=bg.map
*/
